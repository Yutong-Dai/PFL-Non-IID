==================================================
Algorithm: pFedMe
Local batch size: 64
Local steps: 5
Local learing rate: 0.01
Total number of clients: 20
Clients join in each round: 0.4
Client drop rate: 0.0
Time select: False
Time threthold: 10000
Global rounds: 100
Running times: 1
Dataset: Cifar100
Local model: cnn
Using device: cuda
Cuda device id: 1
==================================================

============= Running time: 0th =============
Creating server and clients ...

Join ratio / total clients: 0.4 / 20
Finished creating server and clients.

-------------Round number: 0-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2668

-------------Round number: 1-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2796

-------------Round number: 2-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2739

-------------Round number: 3-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.3037

-------------Round number: 4-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2750

-------------Round number: 5-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2834

-------------Round number: 6-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2807

-------------Round number: 7-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2652

-------------Round number: 8-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2811

-------------Round number: 9-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2697

-------------Round number: 10-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2791

-------------Round number: 11-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2839

-------------Round number: 12-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.3095

-------------Round number: 13-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.3004

-------------Round number: 14-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2937

-------------Round number: 15-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2916

-------------Round number: 16-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.3035

-------------Round number: 17-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2565

-------------Round number: 18-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2920

-------------Round number: 19-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2951

-------------Round number: 20-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2772

-------------Round number: 21-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2955

-------------Round number: 22-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2891

-------------Round number: 23-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2903

-------------Round number: 24-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.3023

-------------Round number: 25-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2813

-------------Round number: 26-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2877

-------------Round number: 27-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2829

-------------Round number: 28-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2986

-------------Round number: 29-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2909

-------------Round number: 30-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2906

-------------Round number: 31-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2979

-------------Round number: 32-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2986

-------------Round number: 33-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2906

-------------Round number: 34-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2787

-------------Round number: 35-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2821

-------------Round number: 36-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2902

-------------Round number: 37-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2909

-------------Round number: 38-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2964

-------------Round number: 39-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2721

-------------Round number: 40-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2711

-------------Round number: 41-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.3008

-------------Round number: 42-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2822

-------------Round number: 43-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2642

-------------Round number: 44-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2756

-------------Round number: 45-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2865

-------------Round number: 46-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2906

-------------Round number: 47-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2732

-------------Round number: 48-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2990

-------------Round number: 49-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2653

-------------Round number: 50-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2821

-------------Round number: 51-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2993

-------------Round number: 52-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2903

-------------Round number: 53-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2784

-------------Round number: 54-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2830

-------------Round number: 55-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2874

-------------Round number: 56-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2803

-------------Round number: 57-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2707

-------------Round number: 58-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2962

-------------Round number: 59-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2867

-------------Round number: 60-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2759

-------------Round number: 61-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2924

-------------Round number: 62-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.3026

-------------Round number: 63-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2803

-------------Round number: 64-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.3091

-------------Round number: 65-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2918

-------------Round number: 66-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2852

-------------Round number: 67-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2684

-------------Round number: 68-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2849

-------------Round number: 69-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2707

-------------Round number: 70-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2787

-------------Round number: 71-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2819

-------------Round number: 72-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2881

-------------Round number: 73-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2776

-------------Round number: 74-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2729

-------------Round number: 75-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2806

-------------Round number: 76-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.3085

-------------Round number: 77-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2779

-------------Round number: 78-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2839

-------------Round number: 79-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2789

-------------Round number: 80-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2911

-------------Round number: 81-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2729

-------------Round number: 82-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2638

-------------Round number: 83-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2778

-------------Round number: 84-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2817

-------------Round number: 85-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2831

-------------Round number: 86-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2928

-------------Round number: 87-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2960

-------------Round number: 88-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2938

-------------Round number: 89-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2981

-------------Round number: 90-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2939

-------------Round number: 91-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2721

-------------Round number: 92-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2839

-------------Round number: 93-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2885

-------------Round number: 94-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2739

-------------Round number: 95-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2817

-------------Round number: 96-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2801

-------------Round number: 97-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2981

-------------Round number: 98-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2824

-------------Round number: 99-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2821

-------------Round number: 100-------------

Evaluate personalized model
Average Personalized Test Accurancy: 0.2894

Best personalized results.
0.30951199338296115

Average time cost: 2207.25s.
Length:  101
std for best accurancy: 0.0
mean for best accurancy: 0.30951199338296115
All done!

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 76750764 	Used Memory: 222.28M
The allocated memory on cuda:0: 222.41M
Memory differs due to the matrix alignment or invisible gradient buffer tensors
-------------------------------------------------------------------------------
